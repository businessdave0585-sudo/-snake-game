<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Jeu Snake Simple</title>
  <style>
    body { display: flex; justify-content: center; align-items: center; height: 100vh; background: #222; }
      #top-bar {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 20px;
        margin-top: 20px;
      }
      canvas {
        background: #111;
        border: 6px solid #ff9800;
        box-shadow: 0 0 24px #ff9800cc, 0 0 8px #fff8;
        border-radius: 18px;
      }
  </style>
</head>
  <body>
    <!-- Ecran d'accueil -->
    <div id="welcome-screen" style="position:fixed;z-index:10;top:0;left:0;width:100vw;height:100vh;background:#111;display:flex;flex-direction:column;align-items:center;justify-content:center;">
      <canvas id="fireworks-canvas" style="position:absolute;top:0;left:0;width:100vw;height:100vh;z-index:1;"></canvas>
      <div style="position:relative;z-index:2;display:flex;flex-direction:column;align-items:center;">
        <h1 style="color:#fff;font-size:2.2em;text-shadow:0 2px 12px #306998,0 0 40px #fff;letter-spacing:2px;margin-bottom:18px;">Bienvenue au jeu snake de DAVID</h1>
        <button id="welcome-start-btn" style="padding:18px 50px;font-size:1.5em;background:#ff9800;color:#fff;border:none;border-radius:12px;cursor:pointer;box-shadow:0 2px 8px #0004;margin-bottom:18px;">Commencer</button>
        <div id="countdown" style="color:#fff;font-size:2.5em;font-weight:bold;margin-top:10px;display:none;text-shadow:0 2px 12px #ff9800,0 0 40px #fff;"></div>
      </div>
    </div>
    <div id="top-bar">
      <button id="start-btn" style="padding:15px 40px;font-size:1.2em;background:#306998;color:#fff;border:none;border-radius:8px;cursor:pointer;">DÃ©marrer le jeu</button>
      <button id="mute-btn" style="padding:12px 25px;font-size:1em;background:#222;color:#fff;border:none;border-radius:8px;cursor:pointer;">ðŸ”Š Son</button>
      <span id="highscore-label" style="font-size:1.1em;color:#306998;font-weight:bold;">Meilleur score : 0</span>
    </div>
    <div id="game-container" style="position: relative; width: 900px; height: 900px; margin: auto; opacity:0.5; pointer-events:none;">
      <img src="https://upload.wikimedia.org/wikipedia/commons/c/c3/Python-logo-notext.svg" alt="python" style="position: absolute; left: -90px; top: 50%; transform: translateY(-50%); width: 90px; height: 90px;">
      <img src="https://upload.wikimedia.org/wikipedia/commons/c/c3/Python-logo-notext.svg" alt="python" style="position: absolute; right: -90px; top: 50%; transform: translateY(-50%) scaleX(-1); width: 90px; height: 90px;">
      <img src="https://upload.wikimedia.org/wikipedia/commons/c/c3/Python-logo-notext.svg" alt="python" style="position: absolute; top: -90px; left: 50%; transform: translateX(-50%); width: 90px; height: 90px;">
      <img src="https://upload.wikimedia.org/wikipedia/commons/c/c3/Python-logo-notext.svg" alt="python" style="position: absolute; bottom: -90px; left: 50%; transform: translateX(-50%) scaleY(-1); width: 90px; height: 90px;">
      <canvas id="game" width="900" height="900"></canvas>
    </div>
  <script>
  // --- FEU D'ARTIFICE ---
  const fwCanvas = document.getElementById('fireworks-canvas');
  const fwCtx = fwCanvas.getContext('2d');
  function resizeFW() {
    fwCanvas.width = window.innerWidth;
    fwCanvas.height = window.innerHeight;
  }
  resizeFW();
  window.addEventListener('resize', resizeFW);
  // Particules feu d'artifice
  function randomColor() {
    const colors = ['#ff9800','#ffeb3b','#00e676','#00bcd4','#3f51b5','#e91e63','#fff'];
    return colors[Math.floor(Math.random()*colors.length)];
  }
  class Particle {
    constructor(x, y, color) {
      this.x = x; this.y = y;
      this.radius = 2 + Math.random()*2;
      this.color = color;
      this.angle = Math.random()*2*Math.PI;
      this.speed = 2 + Math.random()*4;
      this.alpha = 1;
      this.decay = 0.01 + Math.random()*0.015;
    }
    update() {
      this.x += Math.cos(this.angle)*this.speed;
      this.y += Math.sin(this.angle)*this.speed;
      this.speed *= 0.98;
      this.alpha -= this.decay;
    }
    draw(ctx) {
      ctx.save();
      ctx.globalAlpha = Math.max(this.alpha,0);
      ctx.beginPath();
      ctx.arc(this.x, this.y, this.radius, 0, 2*Math.PI);
      ctx.fillStyle = this.color;
      ctx.fill();
      ctx.restore();
    }
  }
  let fireworks = [];
  function launchFirework() {
    const x = Math.random()*fwCanvas.width*0.8 + fwCanvas.width*0.1;
    const y = Math.random()*fwCanvas.height*0.4 + fwCanvas.height*0.1;
    const color = randomColor();
    for(let i=0;i<32;i++) {
      fireworks.push(new Particle(x, y, color));
    }
  }
  setInterval(launchFirework, 900);
  function animateFW() {
    fwCtx.clearRect(0,0,fwCanvas.width,fwCanvas.height);
    fireworks.forEach(p=>{p.update();p.draw(fwCtx);});
    fireworks = fireworks.filter(p=>p.alpha>0);
    requestAnimationFrame(animateFW);
  }
  animateFW();
  // --- FIN FEU D'ARTIFICE ---

  // Gestion du bouton Commencer et du dÃ©compte
  const welcomeScreen = document.getElementById('welcome-screen');
  const welcomeStartBtn = document.getElementById('welcome-start-btn');
  const countdownDiv = document.getElementById('countdown');
  welcomeStartBtn.addEventListener('click', function() {
    welcomeStartBtn.style.display = 'none';
    countdownDiv.style.display = 'block';
    let count = 3;
    countdownDiv.textContent = count;
    const interval = setInterval(()=>{
      count--;
      if(count>0) {
        countdownDiv.textContent = count;
      } else {
        countdownDiv.textContent = 'Go!';
        setTimeout(()=>{
          welcomeScreen.style.display = 'none';
        }, 600);
        clearInterval(interval);
      }
    }, 900);
  });
  </script>
  <!-- Sons distincts et libres -->
  <audio id="eat-sound" src="https://cdn.pixabay.com/audio/2022/10/16/audio_12b1b7b6e2.mp3"></audio> <!-- pop -->
  <audio id="lose-sound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_115b9b7bfa.mp3"></audio> <!-- fail -->
  <audio id="bg-sound" src="https://cdn.pixabay.com/audio/2022/10/16/audio_12b1b7b6e2.mp3" loop></audio> <!-- simple fond -->
  <script>
  const canvas = document.getElementById('game');
  const ctx = canvas.getContext('2d');
  const grid = 30; // taille d'une case
  let snake = [{x: 10 * grid, y: 15 * grid}];
  let dx = grid, dy = 0;
  let food = {x: 15 * grid, y: 15 * grid};
  let score = 0;
  let speed = 180; // vitesse de dÃ©part plus lente (ms)
  let loopId;
  // Sons
  const eatSound = document.getElementById('eat-sound');
  const loseSound = document.getElementById('lose-sound');
  const bgSound = document.getElementById('bg-sound');
  // ContrÃ´le dÃ©marrage
  const startBtn = document.getElementById('start-btn');
  const muteBtn = document.getElementById('mute-btn');
  const highscoreLabel = document.getElementById('highscore-label');
  const gameContainer = document.getElementById('game-container');
  let muted = false;
  let highscore = localStorage.getItem('snake_highscore') ? parseInt(localStorage.getItem('snake_highscore')) : 0;
  highscoreLabel.textContent = 'Meilleur score : ' + highscore;

    function drawSnake() {
      ctx.fillStyle = '#0f0';
      snake.forEach(part => ctx.fillRect(part.x, part.y, grid, grid));
    }

    function drawFood() {
      ctx.fillStyle = '#f00';
      ctx.fillRect(food.x, food.y, grid, grid);
    }

    function moveSnake() {
      const head = {x: snake[0].x + dx, y: snake[0].y + dy};
      snake.unshift(head);
      if (head.x === food.x && head.y === food.y) {
        score++;
        if (!muted && eatSound) { try { eatSound.currentTime = 0; eatSound.play(); } catch(e){} }
        // GÃ©nÃ©rer la nourriture dans la grille 30x30 (900/30 = 30)
        food = {
          x: Math.floor(Math.random() * 30) * grid,
          y: Math.floor(Math.random() * 30) * grid
        };
        // Le snake grandit (on ne retire pas la queue)
        // Augmenter la vitesse progressivement (ralentir l'intervalle)
        if (speed > 60) {
          speed -= 5;
          clearInterval(loopId);
          loopId = setInterval(gameLoop, speed);
        }
      } else {
        snake.pop();
      }
    }

    function checkCollision() {
      const head = snake[0];
      if (head.x < 0 || head.x >= 900 || head.y < 0 || head.y >= 900) return true;
      for (let i = 1; i < snake.length; i++) {
        if (head.x === snake[i].x && head.y === snake[i].y) return true;
      }
      return false;
    }

    function gameLoop() {
      if (checkCollision()) {
        // Son de perdant
        if (!muted && loseSound) { try { loseSound.currentTime = 0; loseSound.play(); } catch(e){} }
        // Highscore
        if (score > highscore) {
          highscore = score;
          localStorage.setItem('snake_highscore', highscore);
          highscoreLabel.textContent = 'Meilleur score : ' + highscore;
        }
         // Vibration Ã  la fin de la partie (si supportÃ©)
         if (window.navigator && window.navigator.vibrate) {
           window.navigator.vibrate([200, 100, 200]);
         }
         setTimeout(() => {
           let again = confirm('Game Over! Score: ' + score + '\nVoulez-vous rejouer ? (OK = Rejouer, Annuler = Quitter)');
           if (again) {
             // RÃ©initialiser le jeu
             snake = [{x: 10 * grid, y: 15 * grid}];
             dx = grid; dy = 0;
             food = {x: 15 * grid, y: 15 * grid};
             score = 0;
             speed = 180;
             ctx.clearRect(0, 0, 900, 900);
             clearInterval(loopId);
             loopId = setInterval(gameLoop, speed);
             if (!muted && bgSound) { try { bgSound.currentTime = 0; bgSound.play(); } catch(e){} }
           } else {
             if (bgSound) bgSound.pause();
             window.close();
           }
         }, 100);
        clearInterval(loopId);
        return;
      }
      ctx.clearRect(0, 0, 900, 900);
      drawFood();
      moveSnake();
      drawSnake();
    }

    document.addEventListener('keydown', e => {
      if (e.key === 'ArrowUp' && dy === 0) { dx = 0; dy = -grid; }
      else if (e.key === 'ArrowDown' && dy === 0) { dx = 0; dy = grid; }
      else if (e.key === 'ArrowLeft' && dx === 0) { dx = -grid; dy = 0; }
      else if (e.key === 'ArrowRight' && dx === 0) { dx = grid; dy = 0; }
    });

    // ContrÃ´le tactile (swipe)
    let touchStartX = 0, touchStartY = 0;
    let touchEndX = 0, touchEndY = 0;
    canvas.addEventListener('touchstart', function(e) {
      if (e.touches.length === 1) {
        touchStartX = e.touches[0].clientX;
        touchStartY = e.touches[0].clientY;
      }
    });
    canvas.addEventListener('touchmove', function(e) {
      if (e.touches.length === 1) {
        touchEndX = e.touches[0].clientX;
        touchEndY = e.touches[0].clientY;
      }
    });
    canvas.addEventListener('touchend', function(e) {
      let dxTouch = touchEndX - touchStartX;
      let dyTouch = touchEndY - touchStartY;
      if (Math.abs(dxTouch) > Math.abs(dyTouch)) {
        // Swipe horizontal
        if (dxTouch > 30 && dx === 0) { dx = grid; dy = 0; } // droite
        else if (dxTouch < -30 && dx === 0) { dx = -grid; dy = 0; } // gauche
      } else {
        // Swipe vertical
        if (dyTouch > 30 && dy === 0) { dx = 0; dy = grid; } // bas
        else if (dyTouch < -30 && dy === 0) { dx = 0; dy = -grid; } // haut
      }
    });

    // DÃ©marrage du jeu aprÃ¨s interaction utilisateur
    function startGame() {
      gameContainer.style.opacity = 1;
      gameContainer.style.pointerEvents = 'auto';
      startBtn.style.display = 'none';
      if (loopId) clearInterval(loopId);
      loopId = setInterval(gameLoop, speed);
      if (!muted && bgSound) { try { bgSound.currentTime = 0; bgSound.volume = 0.2; bgSound.play(); } catch(e){} }
    }
    startBtn.addEventListener('click', startGame);

    // Mute/Unmute
    muteBtn.addEventListener('click', function() {
      muted = !muted;
      if (muted) {
        muteBtn.textContent = 'ðŸ”‡ Muet';
        if (bgSound) bgSound.pause();
      } else {
        muteBtn.textContent = 'ðŸ”Š Son';
        if (startBtn.style.display === 'none' && bgSound) { try { bgSound.currentTime = 0; bgSound.play(); } catch(e){} }
      }
    });
  </script>
</body>
</html>
